<div class="procedures-banner" id="top-banner" style="background-image: linear-gradient(rgba(0,0,0,0.2),rgba(0,0,0,0.4)), url('https://res.cloudinary.com/dcs2vqe2s/image/upload/v1660653517/gavel-gbf4d8f0fc_1920_blzqpt.jpg')">
  <div class="container">
    <h1><%= @lawfirm.name %>
    </h1>
  </div>
</div>
<div class="container">
  <% if current_user.consultations.any?%>
    <div class="wrapper-lawfirms-show">
      <div class="lawfirms-show-description-card">
        <div class="consultations-flex">
          <div class="left-right">
            <h1>Description:</h1>
          </div>
          <div class="left-right">
            <h1>
              <%= link_to toggle_favorite_lawfirm_path(@lawfirm), remote: true, method: :post do %>
                <%= render 'lawfirms/like_button', lawfirm: @lawfirm %>
              <% end %>
            </h1>
          </div>
        </div>
        <p>
          <% if @lawfirm.description %>
            <%= @lawfirm.description %>
          <% else %>
            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Rem facilis numquam qui aliquid dolorem necessitatibus molestias mollitia, placeat consectetur eligendi modi pariatur omnis dolores ex.
          <% end %>
        </p>
      </div>
      <div class="lawfirms-show-need-help-card">
        <h5>Need help from <%= @lawfirm.name %>?</h5>
        <p>Which application do you need help with?</p>
        <% current_user.consultations.each do |consultation| %>
          <%= simple_form_for [@lawfirm, consultation] do |f| %>
            <%= f.submit "+", class: "btn button-consultationscenter"%> <%= consultation.procedure.name %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="wrapper-lawfirms-show">
      <div class="lawfirms-show-description-card">
        <div class="consultations-flex">
          <div class="left-right">
            <h1>Description:</h1>
          </div>
          <div class="left-right">
            <h1>
              <%= link_to toggle_favorite_lawfirm_path(@lawfirm), remote: true, method: :post do %>
                <%= render 'lawfirms/like_button', lawfirm: @lawfirm %>
              <% end %>
            </h1>
          </div>
        </div>
        <p>
          <% if @lawfirm.description %>
            <%= @lawfirm.description %>
          <% else %>
            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Rem facilis numquam qui aliquid dolorem necessitatibus molestias mollitia, placeat consectetur eligendi modi pariatur omnis dolores ex.
          <% end %>
        </p>
      </div>
    </div>
  <% end %>
  <div class="wrapper-lawfirms-show">
    <div class="cards-lawfirms-show">
      <div class="card-lawfirms-show">
        <h1>Information:</h1>
        <div class="user-info-lawfirms-show">
          <ul>
            <li>
              <p><i class="fa-solid fa-location-pin"></i></p>
              <p>Location: <%= @lawfirm.address %>, <%= @lawfirm.location %></p>
            </li>
            <li>
              <p><i class="fa-solid fa-phone"></i></p>
              <p>Telephone Number: 123-(4567)-890 </p>
            </li>
            <li>
              <p><i class="fa-solid fa-fax"></i></p>
              <p>Fax Number: 123-(4567)-890 </p>
            </li>
            <li>
              <p><i class="fa-solid fa-tag"></i></p>
              <% if @lawfirm.tag_list.empty? %>
                <p>There are no taglists/specialties</p>
              <% else %>
                <p>Specialty: <%= @lawfirm.tag_list %></p>
              <% end %>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="map-lawfirms-show"
        data-controller="mapbox"
        data-mapbox-markers-value="<%= @markers.to_json %>"
        data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
  <div class="lawfirms-show-description-card">
    <h1><%= pluralize @lawfirm.reviews.size, "review" %></h1>
    <div data-controller="insert-in-list">
      <div id="reviews" data-insert-in-list-target="items">
        <% if @lawfirm.reviews.blank? %>
          Be the first to leave a review for <%= @lawfirm.name %>
        <% else %>
          <% @lawfirm.reviews.each do |review| %>
            <div id="review-<%= review.id %>">
              <p class="lawfirm-review"><%= review.content %></p>
              <p><%  review.rating.to_i.times do  %>
                  <i class="fa-solid fa-star star-yellow"></i>
                <% end %></p>
            </div>
          <% end %>
        <% end %>
      </div>
      <%= render 'reviews/form', lawfirm: @lawfirm, review: @review %>
    </div>
  </div>
  <div class="lawfirms-show-description-card">
    <h1>Similar Law Firms:</h1>
    <% if @related_lawfirms.any? %>
      <ul>
        <% @related_lawfirms.each do |r| %>
          <li><%= link_to r.name, lawfirm_path(r) %></li>
        <% end %>
      </ul>
    <% else %>
      <p>There are no similar law firms</p>
    <% end %>
  </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script>
  $(function () {
      $('[data-toggle="tooltip"]').tooltip();
  });
</script>
